{"version":"1.131.0","results":[{"check_id":"yaml.github-actions.security.run-shell-injection.run-shell-injection","path":"/src/.github/workflows/ephemeral-environment.yml","start":{"line":49,"col":7,"offset":1269},"end":{"line":63,"col":2,"offset":2048},"extra":{"message":"Using variable interpolation `${{...}}` with `github` context data in a `run:` step could allow an attacker to inject their own code into the runner. This would allow them to steal secrets and code. `github` context data can have arbitrary user input and should be treated as untrusted. Instead, use an intermediate environment variable with `env:` to store the data and use the environment variable in the `run:` script. Be sure to use double-quotes the environment variable, like this: \"$ENVVAR\".","metadata":{"category":"security","cwe":["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://docs.github.com/en/actions/learn-github-actions/security-hardening-for-github-actions#understanding-the-risk-of-script-injections","https://securitylab.github.com/research/github-actions-untrusted-input/"],"technology":["github-actions"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"HIGH","confidence":"HIGH","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Command Injection"],"source":"https://semgrep.dev/r/yaml.github-actions.security.run-shell-injection.run-shell-injection","shortlink":"https://sg.run/pkzk"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"yaml.github-actions.security.run-shell-injection.run-shell-injection","path":"/src/.github/workflows/ephemeral-environment.yml","start":{"line":113,"col":7,"offset":3715},"end":{"line":119,"col":12,"offset":3940},"extra":{"message":"Using variable interpolation `${{...}}` with `github` context data in a `run:` step could allow an attacker to inject their own code into the runner. This would allow them to steal secrets and code. `github` context data can have arbitrary user input and should be treated as untrusted. Instead, use an intermediate environment variable with `env:` to store the data and use the environment variable in the `run:` script. Be sure to use double-quotes the environment variable, like this: \"$ENVVAR\".","metadata":{"category":"security","cwe":["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://docs.github.com/en/actions/learn-github-actions/security-hardening-for-github-actions#understanding-the-risk-of-script-injections","https://securitylab.github.com/research/github-actions-untrusted-input/"],"technology":["github-actions"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"HIGH","confidence":"HIGH","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Command Injection"],"source":"https://semgrep.dev/r/yaml.github-actions.security.run-shell-injection.run-shell-injection","shortlink":"https://sg.run/pkzk"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"yaml.github-actions.security.run-shell-injection.run-shell-injection","path":"/src/.github/workflows/production-deployment.yml","start":{"line":204,"col":9,"offset":8096},"end":{"line":225,"col":2,"offset":9105},"extra":{"message":"Using variable interpolation `${{...}}` with `github` context data in a `run:` step could allow an attacker to inject their own code into the runner. This would allow them to steal secrets and code. `github` context data can have arbitrary user input and should be treated as untrusted. Instead, use an intermediate environment variable with `env:` to store the data and use the environment variable in the `run:` script. Be sure to use double-quotes the environment variable, like this: \"$ENVVAR\".","metadata":{"category":"security","cwe":["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://docs.github.com/en/actions/learn-github-actions/security-hardening-for-github-actions#understanding-the-risk-of-script-injections","https://securitylab.github.com/research/github-actions-untrusted-input/"],"technology":["github-actions"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"HIGH","confidence":"HIGH","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Command Injection"],"source":"https://semgrep.dev/r/yaml.github-actions.security.run-shell-injection.run-shell-injection","shortlink":"https://sg.run/pkzk"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"python.lang.security.audit.non-literal-import.non-literal-import","path":"/src/conftest.py","start":{"line":102,"col":21,"offset":3705},"end":{"line":102,"col":53,"offset":3737},"extra":{"message":"Untrusted user input in `importlib.import_module()` function allows an attacker to load arbitrary code. Avoid dynamic values in `importlib.import_module()` or use a whitelist to prevent running untrusted code.","metadata":{"owasp":["A01:2021 - Broken Access Control"],"cwe":["CWE-706: Use of Incorrectly-Resolved Name or Reference"],"category":"security","technology":["python"],"references":["https://owasp.org/Top10/A01_2021-Broken_Access_Control"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/python.lang.security.audit.non-literal-import.non-literal-import","shortlink":"https://sg.run/y6Jk"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"dockerfile.security.missing-user.missing-user","path":"/src/containers/collector-scheduler/Dockerfile","start":{"line":9,"col":1,"offset":275},"end":{"line":9,"col":26,"offset":300},"extra":{"message":"By not specifying a USER, a program in the container may run as 'root'. This is a security hazard. If an attacker can control a process running as root, they may have control over the container. Ensure that the last USER in a Dockerfile is a USER other than 'root'.","fix":"USER non-root\nCMD [\"python\", \"main.py\"]","metadata":{"cwe":["CWE-250: Execution with Unnecessary Privileges"],"category":"security","technology":["dockerfile"],"confidence":"MEDIUM","owasp":["A04:2021 - Insecure Design"],"references":["https://owasp.org/Top10/A04_2021-Insecure_Design"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/dockerfile.security.missing-user.missing-user","shortlink":"https://sg.run/Gbvn"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"python.lang.security.audit.non-literal-import.non-literal-import","path":"/src/containers/content-collector/collector.py","start":{"line":377,"col":36,"offset":12487},"end":{"line":377,"col":70,"offset":12521},"extra":{"message":"Untrusted user input in `importlib.import_module()` function allows an attacker to load arbitrary code. Avoid dynamic values in `importlib.import_module()` or use a whitelist to prevent running untrusted code.","metadata":{"owasp":["A01:2021 - Broken Access Control"],"cwe":["CWE-706: Use of Incorrectly-Resolved Name or Reference"],"category":"security","technology":["python"],"references":["https://owasp.org/Top10/A01_2021-Broken_Access_Control"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/python.lang.security.audit.non-literal-import.non-literal-import","shortlink":"https://sg.run/y6Jk"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"python.lang.security.audit.insecure-transport.requests.request-with-http.request-with-http","path":"/src/containers/content-enricher/config.py","start":{"line":112,"col":17,"offset":3020},"end":{"line":112,"col":56,"offset":3059},"extra":{"message":"Detected a request using 'http://'. This request will be unencrypted, and attackers could listen into traffic on the network and be able to obtain sensitive information. Use 'https://' instead.","metadata":{"owasp":["A03:2017 - Sensitive Data Exposure","A02:2021 - Cryptographic Failures"],"cwe":["CWE-319: Cleartext Transmission of Sensitive Information"],"asvs":{"control_id":"9.1.1 Weak TLS","control_url":"https://github.com/OWASP/ASVS/blob/master/4.0/en/0x17-V9-Communications.md#v92-server-communications-security-requirements","section":"V9 Communications Verification Requirements","version":"4"},"category":"security","technology":["requests"],"references":["https://owasp.org/Top10/A02_2021-Cryptographic_Failures"],"subcategory":["audit"],"likelihood":"LOW","impact":"LOW","confidence":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Mishandled Sensitive Information"],"source":"https://semgrep.dev/r/python.lang.security.audit.insecure-transport.requests.request-with-http.request-with-http","shortlink":"https://sg.run/W8J4"},"severity":"INFO","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"dockerfile.security.missing-user.missing-user","path":"/src/containers/content-generator/Dockerfile","start":{"line":26,"col":1,"offset":604},"end":{"line":26,"col":67,"offset":670},"extra":{"message":"By not specifying a USER, a program in the container may run as 'root'. This is a security hazard. If an attacker can control a process running as root, they may have control over the container. Ensure that the last USER in a Dockerfile is a USER other than 'root'.","fix":"USER non-root\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\", \"--port\", \"8000\"]","metadata":{"cwe":["CWE-250: Execution with Unnecessary Privileges"],"category":"security","technology":["dockerfile"],"confidence":"MEDIUM","owasp":["A04:2021 - Insecure Design"],"references":["https://owasp.org/Top10/A04_2021-Insecure_Design"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/dockerfile.security.missing-user.missing-user","shortlink":"https://sg.run/Gbvn"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"python.lang.security.audit.insecure-transport.requests.request-with-http.request-with-http","path":"/src/containers/content-processor/config.py","start":{"line":78,"col":17,"offset":2363},"end":{"line":78,"col":56,"offset":2402},"extra":{"message":"Detected a request using 'http://'. This request will be unencrypted, and attackers could listen into traffic on the network and be able to obtain sensitive information. Use 'https://' instead.","metadata":{"owasp":["A03:2017 - Sensitive Data Exposure","A02:2021 - Cryptographic Failures"],"cwe":["CWE-319: Cleartext Transmission of Sensitive Information"],"asvs":{"control_id":"9.1.1 Weak TLS","control_url":"https://github.com/OWASP/ASVS/blob/master/4.0/en/0x17-V9-Communications.md#v92-server-communications-security-requirements","section":"V9 Communications Verification Requirements","version":"4"},"category":"security","technology":["requests"],"references":["https://owasp.org/Top10/A02_2021-Cryptographic_Failures"],"subcategory":["audit"],"likelihood":"LOW","impact":"LOW","confidence":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Mishandled Sensitive Information"],"source":"https://semgrep.dev/r/python.lang.security.audit.insecure-transport.requests.request-with-http.request-with-http","shortlink":"https://sg.run/W8J4"},"severity":"INFO","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"dockerfile.security.missing-user.missing-user","path":"/src/containers/markdown-generator/Dockerfile","start":{"line":37,"col":1,"offset":862},"end":{"line":37,"col":67,"offset":928},"extra":{"message":"By not specifying a USER, a program in the container may run as 'root'. This is a security hazard. If an attacker can control a process running as root, they may have control over the container. Ensure that the last USER in a Dockerfile is a USER other than 'root'.","fix":"USER non-root\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\", \"--port\", \"8000\"]","metadata":{"cwe":["CWE-250: Execution with Unnecessary Privileges"],"category":"security","technology":["dockerfile"],"confidence":"MEDIUM","owasp":["A04:2021 - Insecure Design"],"references":["https://owasp.org/Top10/A04_2021-Insecure_Design"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/dockerfile.security.missing-user.missing-user","shortlink":"https://sg.run/Gbvn"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"dockerfile.security.missing-user.missing-user","path":"/src/containers/site-generator/Dockerfile","start":{"line":33,"col":1,"offset":900},"end":{"line":33,"col":90,"offset":989},"extra":{"message":"By not specifying a USER, a program in the container may run as 'root'. This is a security hazard. If an attacker can control a process running as root, they may have control over the container. Ensure that the last USER in a Dockerfile is a USER other than 'root'.","fix":"USER non-root\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\", \"--port\", \"8000\", \"--log-level\", \"info\"]","metadata":{"cwe":["CWE-250: Execution with Unnecessary Privileges"],"category":"security","technology":["dockerfile"],"confidence":"MEDIUM","owasp":["A04:2021 - Insecure Design"],"references":["https://owasp.org/Top10/A04_2021-Insecure_Design"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/dockerfile.security.missing-user.missing-user","shortlink":"https://sg.run/Gbvn"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"python.fastapi.security.wildcard-cors.wildcard-cors","path":"/src/containers/site-generator/main.py","start":{"line":84,"col":19,"offset":2224},"end":{"line":84,"col":24,"offset":2229},"extra":{"message":"CORS policy allows any origin (using wildcard '*'). This is insecure and should be avoided.","metadata":{"cwe":["CWE-942: Permissive Cross-domain Policy with Untrusted Domains"],"owasp":["A05:2021 - Security Misconfiguration"],"category":"security","technology":["python","fastapi"],"references":["https://owasp.org/Top10/A05_2021-Security_Misconfiguration","https://cwe.mitre.org/data/definitions/942.html"],"likelihood":"HIGH","impact":"LOW","confidence":"MEDIUM","vulnerability_class":["Configuration"],"subcategory":["vuln"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","source":"https://semgrep.dev/r/python.fastapi.security.wildcard-cors.wildcard-cors","shortlink":"https://sg.run/KxApY"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"python.fastapi.security.wildcard-cors.wildcard-cors","path":"/src/containers/site-generator/main_new.py","start":{"line":84,"col":19,"offset":2224},"end":{"line":84,"col":24,"offset":2229},"extra":{"message":"CORS policy allows any origin (using wildcard '*'). This is insecure and should be avoided.","metadata":{"cwe":["CWE-942: Permissive Cross-domain Policy with Untrusted Domains"],"owasp":["A05:2021 - Security Misconfiguration"],"category":"security","technology":["python","fastapi"],"references":["https://owasp.org/Top10/A05_2021-Security_Misconfiguration","https://cwe.mitre.org/data/definitions/942.html"],"likelihood":"HIGH","impact":"LOW","confidence":"MEDIUM","vulnerability_class":["Configuration"],"subcategory":["vuln"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","source":"https://semgrep.dev/r/python.fastapi.security.wildcard-cors.wildcard-cors","shortlink":"https://sg.run/KxApY"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"python.flask.security.xss.audit.direct-use-of-jinja2.direct-use-of-jinja2","path":"/src/containers/site-generator/main_old.py","start":{"line":366,"col":20,"offset":13782},"end":{"line":366,"col":46,"offset":13808},"extra":{"message":"Detected direct use of jinja2. If not done properly, this may bypass HTML escaping which opens up the application to cross-site scripting (XSS) vulnerabilities. Prefer using the Flask method 'render_template()' and templates with a '.html' extension in order to prevent XSS.","metadata":{"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"references":["https://jinja.palletsprojects.com/en/2.11.x/api/#basics"],"category":"security","technology":["flask"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site-Scripting (XSS)"],"source":"https://semgrep.dev/r/python.flask.security.xss.audit.direct-use-of-jinja2.direct-use-of-jinja2","shortlink":"https://sg.run/RoKe"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"python.flask.security.xss.audit.direct-use-of-jinja2.direct-use-of-jinja2","path":"/src/containers/site-generator/template_manager.py","start":{"line":86,"col":26,"offset":3103},"end":{"line":91,"col":10,"offset":3242},"extra":{"message":"Detected direct use of jinja2. If not done properly, this may bypass HTML escaping which opens up the application to cross-site scripting (XSS) vulnerabilities. Prefer using the Flask method 'render_template()' and templates with a '.html' extension in order to prevent XSS.","metadata":{"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"references":["https://jinja.palletsprojects.com/en/2.11.x/api/#basics"],"category":"security","technology":["flask"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site-Scripting (XSS)"],"source":"https://semgrep.dev/r/python.flask.security.xss.audit.direct-use-of-jinja2.direct-use-of-jinja2","shortlink":"https://sg.run/RoKe"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"python.flask.security.xss.audit.direct-use-of-jinja2.direct-use-of-jinja2","path":"/src/containers/site-generator/template_manager.py","start":{"line":100,"col":20,"offset":3583},"end":{"line":100,"col":46,"offset":3609},"extra":{"message":"Detected direct use of jinja2. If not done properly, this may bypass HTML escaping which opens up the application to cross-site scripting (XSS) vulnerabilities. Prefer using the Flask method 'render_template()' and templates with a '.html' extension in order to prevent XSS.","metadata":{"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"references":["https://jinja.palletsprojects.com/en/2.11.x/api/#basics"],"category":"security","technology":["flask"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site-Scripting (XSS)"],"source":"https://semgrep.dev/r/python.flask.security.xss.audit.direct-use-of-jinja2.direct-use-of-jinja2","shortlink":"https://sg.run/RoKe"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"terraform.azure.security.keyvault.keyvault-specify-network-acl.keyvault-specify-network-acl","path":"/src/infra/main.tf","start":{"line":17,"col":1,"offset":276},"end":{"line":17,"col":9,"offset":284},"extra":{"message":"Network ACLs allow you to reduce your exposure to risk by limiting what can access your key vault. The default action of the Network ACL should be set to deny for when IPs are not matched. Azure services can be allowed to bypass.","metadata":{"cwe":["CWE-1220: Insufficient Granularity of Access Control"],"category":"security","technology":["terraform","azure"],"references":["https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault#network_acls","https://docs.microsoft.com/en-us/azure/key-vault/general/network-security"],"owasp":["A05:2017 - Broken Access Control","A01:2021 - Broken Access Control"],"subcategory":["audit"],"likelihood":"LOW","impact":"LOW","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Other"],"source":"https://semgrep.dev/r/terraform.azure.security.keyvault.keyvault-specify-network-acl.keyvault-specify-network-acl","shortlink":"https://sg.run/nKgX"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"terraform.azure.security.storage.storage-allow-microsoft-service-bypass.storage-allow-microsoft-service-bypass","path":"/src/infra/main.tf","start":{"line":151,"col":1,"offset":4844},"end":{"line":174,"col":2,"offset":6072},"extra":{"message":"Some Microsoft services that interact with storage accounts operate from networks that can't be granted access through network rules. To help this type of service work as intended, allow the set of trusted Microsoft services to bypass the network rules","metadata":{"cwe":["CWE-1220: Insufficient Granularity of Access Control"],"category":"security","technology":["terraform","azure"],"references":["https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#bypass","https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account_network_rules#bypass","https://docs.microsoft.com/en-us/azure/storage/common/storage-network-security#trusted-microsoft-services"],"owasp":["A05:2017 - Broken Access Control","A01:2021 - Broken Access Control"],"subcategory":["audit"],"likelihood":"LOW","impact":"LOW","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Other"],"source":"https://semgrep.dev/r/terraform.azure.security.storage.storage-allow-microsoft-service-bypass.storage-allow-microsoft-service-bypass","shortlink":"https://sg.run/WpX4"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"terraform.azure.security.storage.storage-queue-services-logging.storage-queue-services-logging","path":"/src/infra/main.tf","start":{"line":151,"col":1,"offset":4844},"end":{"line":174,"col":2,"offset":6072},"extra":{"message":"Storage Analytics logs detailed information about successful and failed requests to a storage service. This information can be used to monitor individual requests and to diagnose issues with a storage service. Requests are logged on a best-effort basis.","metadata":{"cwe":["CWE-778: Insufficient Logging"],"category":"security","technology":["terraform","azure"],"references":["https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#logging","https://docs.microsoft.com/en-us/azure/storage/common/storage-analytics-logging?tabs=dotnet"],"owasp":["A10:2017 - Insufficient Logging & Monitoring","A09:2021 - Security Logging and Monitoring Failures"],"subcategory":["audit"],"likelihood":"LOW","impact":"LOW","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Insufficient Logging"],"source":"https://semgrep.dev/r/terraform.azure.security.storage.storage-queue-services-logging.storage-queue-services-logging","shortlink":"https://sg.run/0yEv"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[{"code":3,"level":"warn","type":"Syntax error","message":"Syntax error at line /src/python-safety-results.json:1:\n missing element","path":"/src/python-safety-results.json"},{"code":2,"level":"warn","type":"Other syntax error","message":"Other syntax error at line /src/.github/workflows/staging-deployment.yml:158:\n (approximate error location; error nearby after) error calling parser: mapping values are not allowed in this context character 0 position 0 returned: 0","path":"/src/.github/workflows/staging-deployment.yml"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"yaml.github-actions.security.curl-eval.curl-eval","message":"Internal matching error when running yaml.github-actions.security.curl-eval.curl-eval on /src/.github/workflows/production-deployment.yml:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nrule yaml.github-actions.security.curl-eval.curl-eval: metavariable-pattern failed when parsing $SHELL's content as Bash: # Skip cost validation if no API key is available\nif [ -z \"${{ secrets.INFRACOST_API_KEY }}\" ]; then\n  echo \"D[aQyP Infracost API key not configured - skipping cost validation\"\n  echo \"R`TL To enable cost validation: Set INFRACOST_API_KEY secret\"\n  echo \"R`Sq Estimated monthly cost: Unknown (validation skipped)\"\n  exit 0\nfi\n\n# Get Infracost API key from Key Vault or fallback to GitHub secrets\nif [ -n \"${{ steps.get-keyvault.outputs.name }}\" ]; then\n  INFRACOST_API_KEY=$(az keyvault secret show --vault-name \"${{ steps.get-keyvault.outputs.name }}\" --name \"infracost-api-key\" --query \"value\" -o tsv 2>/dev/null || echo \"\")\n  if [ -z \"$INFRACOST_API_KEY\" ] || [ \"$INFRACOST_API_KEY\" = \"placeholder-get-from-infracost-io\" ]; then\n    echo \"Using Infracost API key from GitHub secrets fallback\"\n    export INFRACOST_API_KEY=\"${{ secrets.INFRACOST_API_KEY }}\"\n  else\n    echo \"Using Infracost API key from Key Vault\"\n    export INFRACOST_API_KEY=\"$INFRACOST_API_KEY\"\n  fi\nelse\n  echo \"Using Infracost API key from GitHub secrets fallback\"\n  export INFRACOST_API_KEY=\"${{ secrets.INFRACOST_API_KEY }}\"\nfi\n\n# Install and run Infracost\ncurl -fsSL https://raw.githubusercontent.com/infracost/infracost/master/scripts/install.sh | sh\n\ncd infra\ninfracost breakdown --path . --format json --out-file infracost-production.json\n\n# Check if monthly cost exceeds threshold ($100)\nMONTHLY_COST=$(jq -r '.totalMonthlyCost // \"0\"' infracost-production.json | cut -d. -f1)\nif [ \"$MONTHLY_COST\" -gt 100 ]; then\n  echo \"D[aQyP Monthly cost estimate (\\$${MONTHLY_COST}) exceeds production threshold (\\$100)\"\n  echo \"R`TK Consider reviewing resource sizing and optimization\"\n  # Don't fail deployment, just warn\nfi\n\necho \"D]F Cost validation completed: Monthly estimate \\$${MONTHLY_COST}\"\n","path":"/src/.github/workflows/production-deployment.yml"},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/src/.github/workflows/ephemeral-environment.yml","start":{"line":49,"col":13,"offset":1275},"end":{"line":61,"col":4,"offset":1942}}]],"message":"Syntax error at line /src/.github/workflows/ephemeral-environment.yml:49:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `cd infra\nterraform workspace select ${{ env.TERRAFORM_WORKSPACE }} || echo \"Workspace doesn't exist\"\nif terraform workspace list | grep -q \"${{ env.TERRAFORM_WORKSPACE }}\"; then\n  echo \"R`XRQyP Destroying environment: ${{ env.ENVIRONMENT_NAME }}\"\n  terraform destroy -auto-approve -var-file=staging.tfvars \\\n    -var=\"environment_name=${{ env.ENVIRONMENT_NAME }}\" \\\n    -var=\"branch_name=${{ github.head_ref }}\"\n  terraform workspace select default\n  terraform workspace delete ${{ env.TERRAFORM_WORKSPACE }}\n  echo \"D]F Environment ${{ env.ENVIRONMENT_NAME }} destroyed\"\nelse\n  echo \"DEzQyP Workspace ${{ env.TERRAFORM_WORKSPACE }} not found, nothing to destroy\"\nfi\n` was unexpected","path":"/src/.github/workflows/ephemeral-environment.yml","spans":[{"file":"/src/.github/workflows/ephemeral-environment.yml","start":{"line":49,"col":13,"offset":1275},"end":{"line":61,"col":4,"offset":1942}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/src/.github/workflows/ephemeral-environment.yml","start":{"line":86,"col":18,"offset":2667},"end":{"line":90,"col":53,"offset":2900}}]],"message":"Syntax error at line /src/.github/workflows/ephemeral-environment.yml:86:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `\"R`US Running quick security validation for PR environment\"\n# Quick container security scan\ndocker run --rm -v \"$PWD:/workspace\" \\\n  aquasec/trivy:latest fs /workspace/containers \\\n  --format json --output trivy-pr-scan.json || true\n` was unexpected","path":"/src/.github/workflows/ephemeral-environment.yml","spans":[{"file":"/src/.github/workflows/ephemeral-environment.yml","start":{"line":86,"col":18,"offset":2667},"end":{"line":90,"col":53,"offset":2900}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/src/.github/workflows/ephemeral-environment.yml","start":{"line":99,"col":18,"offset":3124},"end":{"line":103,"col":39,"offset":3402}}]],"message":"Syntax error at line /src/.github/workflows/ephemeral-environment.yml:99:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `\"R`hk Running container test suite\"\ncd containers/content-collector && python -m pytest tests/ -v --tb=short\ncd ../content-processor && python -m pytest tests/ -v --tb=short  \ncd ../content-enricher && python -m pytest tests/ -v --tb=short\necho \"D]F All container tests passed\"\n` was unexpected","path":"/src/.github/workflows/ephemeral-environment.yml","spans":[{"file":"/src/.github/workflows/ephemeral-environment.yml","start":{"line":99,"col":18,"offset":3124},"end":{"line":103,"col":39,"offset":3402}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/src/.github/workflows/ephemeral-environment.yml","start":{"line":109,"col":86,"offset":3508},"end":{"line":109,"col":89,"offset":3511}}]],"message":"Syntax error at line /src/.github/workflows/ephemeral-environment.yml:109:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `${{` was unexpected","path":"/src/.github/workflows/ephemeral-environment.yml","spans":[{"file":"/src/.github/workflows/ephemeral-environment.yml","start":{"line":109,"col":86,"offset":3508},"end":{"line":109,"col":89,"offset":3511}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/src/.github/workflows/ephemeral-environment.yml","start":{"line":115,"col":28,"offset":3721},"end":{"line":115,"col":50,"offset":3743}},{"path":"/src/.github/workflows/ephemeral-environment.yml","start":{"line":116,"col":23,"offset":3721},"end":{"line":116,"col":40,"offset":3738}}]],"message":"Syntax error at line /src/.github/workflows/ephemeral-environment.yml:115:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `{ env.ENVIRONMENT_NAME` was unexpected","path":"/src/.github/workflows/ephemeral-environment.yml","spans":[{"file":"/src/.github/workflows/ephemeral-environment.yml","start":{"line":115,"col":28,"offset":3721},"end":{"line":115,"col":50,"offset":3743}},{"file":"/src/.github/workflows/ephemeral-environment.yml","start":{"line":116,"col":23,"offset":3721},"end":{"line":116,"col":40,"offset":3738}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/src/.github/workflows/ephemeral-environment.yml","start":{"line":123,"col":6,"offset":3980},"end":{"line":123,"col":63,"offset":4037}}]],"message":"Syntax error at line /src/.github/workflows/ephemeral-environment.yml:123:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `\"R`MN Environment deployed: ${{ env.ENVIRONMENT_NAME }}\"\n` was unexpected","path":"/src/.github/workflows/ephemeral-environment.yml","spans":[{"file":"/src/.github/workflows/ephemeral-environment.yml","start":{"line":123,"col":6,"offset":3980},"end":{"line":123,"col":63,"offset":4037}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/src/.github/workflows/ephemeral-environment.yml","start":{"line":139,"col":18,"offset":4722},"end":{"line":154,"col":40,"offset":5377}}]],"message":"Syntax error at line /src/.github/workflows/ephemeral-environment.yml:139:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `\"R`UX Running integration tests against ephemeral environment\"\n\n# Test container endpoints\nif [ -n \"${{ steps.env-urls.outputs.collector_url }}\" ]; then\n  curl -f \"${{ steps.env-urls.outputs.collector_url }}/health\" || echo \"D[aQyP Collector health check failed\"\nfi\n\nif [ -n \"${{ steps.env-urls.outputs.processor_url }}\" ]; then\n  curl -f \"${{ steps.env-urls.outputs.processor_url }}/health\" || echo \"D[aQyP Processor health check failed\"\nfi\n\nif [ -n \"${{ steps.env-urls.outputs.enricher_url }}\" ]; then\n  curl -f \"${{ steps.env-urls.outputs.enricher_url }}/health\" || echo \"D[aQyP Enricher health check failed\"\nfi\n\necho \"D]F Integration tests completed\"\n` was unexpected","path":"/src/.github/workflows/ephemeral-environment.yml","spans":[{"file":"/src/.github/workflows/ephemeral-environment.yml","start":{"line":139,"col":18,"offset":4722},"end":{"line":154,"col":40,"offset":5377}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/src/.github/workflows/production-deployment.yml","start":{"line":204,"col":15,"offset":8102},"end":{"line":223,"col":40,"offset":8933}}]],"message":"Syntax error at line /src/.github/workflows/production-deployment.yml:204:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `SECURITY_SCORE=\"${{ steps.security-scoring.outputs.score }}\"\nBLOCKER_FOUND=\"${{ steps.security-scoring.outputs.blocker_found }}\"\n\n# Only block deployment for critical security issues\nif [ \"$BLOCKER_FOUND\" = \"true\" ] && [ \"${{ inputs.skip_security_scan }}\" != \"true\" ]; then\n  echo \"R`[i Production deployment BLOCKED: Critical security issues must be resolved\"\n  echo \"approved=false\" >> $GITHUB_OUTPUT\n  exit 1\nfi\n\n# Warn about low security scores but allow deployment\nif [ \"$SECURITY_SCORE\" -lt 90 ]; then\n  echo \"D[aQyP Production deployment proceeding with WARNINGS:\"\n  echo \"   Security Score: $SECURITY_SCORE/100 (recommended: DJf90)\"\n  echo \"   Please review security findings and plan improvements\"\nelse\n  echo \"D]F Production validation passed (Security Score: $SECURITY_SCORE)\"\nfi\n\necho \"approved=true\" >> $GITHUB_OUTPUT\n` was unexpected","path":"/src/.github/workflows/production-deployment.yml","spans":[{"file":"/src/.github/workflows/production-deployment.yml","start":{"line":204,"col":15,"offset":8102},"end":{"line":223,"col":40,"offset":8933}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/src/.github/workflows/production-deployment.yml","start":{"line":246,"col":30,"offset":9702},"end":{"line":246,"col":86,"offset":9758}}]],"message":"Syntax error at line /src/.github/workflows/production-deployment.yml:246:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `{ needs.pre-production-validation.outputs.security-score` was unexpected","path":"/src/.github/workflows/production-deployment.yml","spans":[{"file":"/src/.github/workflows/production-deployment.yml","start":{"line":246,"col":30,"offset":9702},"end":{"line":246,"col":86,"offset":9758}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/src/.github/workflows/production-deployment.yml","start":{"line":273,"col":20,"offset":10628},"end":{"line":279,"col":76,"offset":10870}}]],"message":"Syntax error at line /src/.github/workflows/production-deployment.yml:273:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `\"R`S  Creating production state backup...\"\ncd infra\nterraform init\nterraform workspace select production || terraform workspace new production\n\n# Export current state\nterraform show -json > production-state-backup-$(date +%Y%m%d-%H%M%S).json\n` was unexpected","path":"/src/.github/workflows/production-deployment.yml","spans":[{"file":"/src/.github/workflows/production-deployment.yml","start":{"line":273,"col":20,"offset":10628},"end":{"line":279,"col":76,"offset":10870}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/src/.github/workflows/production-deployment.yml","start":{"line":283,"col":20,"offset":11001},"end":{"line":291,"col":35,"offset":11262}}]],"message":"Syntax error at line /src/.github/workflows/production-deployment.yml:283:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `\"R`[A Deploying infrastructure to production...\"\ncd infra\nterraform workspace select production\n\n# Plan with production variables\nterraform plan -var-file=\"production.tfvars\" -out=production.tfplan\n\n# Apply the planned changes\nterraform apply production.tfplan\n` was unexpected","path":"/src/.github/workflows/production-deployment.yml","spans":[{"file":"/src/.github/workflows/production-deployment.yml","start":{"line":283,"col":20,"offset":11001},"end":{"line":291,"col":35,"offset":11262}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/src/.github/workflows/production-deployment.yml","start":{"line":295,"col":24,"offset":11412},"end":{"line":295,"col":46,"offset":11434}}]],"message":"Syntax error at line /src/.github/workflows/production-deployment.yml:295:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `c Container deployment` was unexpected","path":"/src/.github/workflows/production-deployment.yml","spans":[{"file":"/src/.github/workflows/production-deployment.yml","start":{"line":295,"col":24,"offset":11412},"end":{"line":295,"col":46,"offset":11434}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/src/.github/workflows/production-deployment.yml","start":{"line":332,"col":10,"offset":12333},"end":{"line":332,"col":13,"offset":12336}},{"path":"/src/.github/workflows/production-deployment.yml","start":{"line":333,"col":18,"offset":12333},"end":{"line":333,"col":21,"offset":12336}},{"path":"/src/.github/workflows/production-deployment.yml","start":{"line":356,"col":6,"offset":12333},"end":{"line":357,"col":72,"offset":12458}}]],"message":"Syntax error at line /src/.github/workflows/production-deployment.yml:332:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `${{` was unexpected","path":"/src/.github/workflows/production-deployment.yml","spans":[{"file":"/src/.github/workflows/production-deployment.yml","start":{"line":332,"col":10,"offset":12333},"end":{"line":332,"col":13,"offset":12336}},{"file":"/src/.github/workflows/production-deployment.yml","start":{"line":333,"col":18,"offset":12333},"end":{"line":333,"col":21,"offset":12336}},{"file":"/src/.github/workflows/production-deployment.yml","start":{"line":356,"col":6,"offset":12333},"end":{"line":357,"col":72,"offset":12458}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/src/.github/workflows/production-deployment.yml","start":{"line":366,"col":6,"offset":14269},"end":{"line":366,"col":56,"offset":14319}}]],"message":"Syntax error at line /src/.github/workflows/production-deployment.yml:366:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `\"R`PxQyP Created deployment tag: $DEPLOYMENT_TAG\"\n` was unexpected","path":"/src/.github/workflows/production-deployment.yml","spans":[{"file":"/src/.github/workflows/production-deployment.yml","start":{"line":366,"col":6,"offset":14269},"end":{"line":366,"col":56,"offset":14319}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/src/.github/workflows/production-deployment.yml","start":{"line":389,"col":10,"offset":14842},"end":{"line":389,"col":13,"offset":14845}},{"path":"/src/.github/workflows/production-deployment.yml","start":{"line":390,"col":18,"offset":14842},"end":{"line":390,"col":21,"offset":14845}},{"path":"/src/.github/workflows/production-deployment.yml","start":{"line":410,"col":6,"offset":14842},"end":{"line":410,"col":50,"offset":14886}}]],"message":"Syntax error at line /src/.github/workflows/production-deployment.yml:389:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `${{` was unexpected","path":"/src/.github/workflows/production-deployment.yml","spans":[{"file":"/src/.github/workflows/production-deployment.yml","start":{"line":389,"col":10,"offset":14842},"end":{"line":389,"col":13,"offset":14845}},{"file":"/src/.github/workflows/production-deployment.yml","start":{"line":390,"col":18,"offset":14842},"end":{"line":390,"col":21,"offset":14845}},{"file":"/src/.github/workflows/production-deployment.yml","start":{"line":410,"col":6,"offset":14842},"end":{"line":410,"col":50,"offset":14886}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/src/.github/workflows/production-deployment.yml","start":{"line":414,"col":20,"offset":16729},"end":{"line":425,"col":58,"offset":17282}}]],"message":"Syntax error at line /src/.github/workflows/production-deployment.yml:414:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `\"R`T[ Production infrastructure deployment completed successfully\"\necho \"R`PXQyP Infrastructure Status: DEPLOYED\"\necho \"R`Tg Container Status: READY FOR DEPLOYMENT\"\necho \"Q!~ Security Score: \\\n  ${{ needs.pre-production-validation.outputs.security-score }}/100\"\necho \"R`TF Deployed: $(date)\"\necho \"\"\necho \"R`[A Next Steps:\"\necho \"  1. Build container images for microservices\"\necho \"  2. Deploy to Azure Container Registry/Instances\"\necho \"  3. Configure container networking and load balancing\"\necho \"  4. Set up monitoring and logging for containers\"\n` was unexpected","path":"/src/.github/workflows/production-deployment.yml","spans":[{"file":"/src/.github/workflows/production-deployment.yml","start":{"line":414,"col":20,"offset":16729},"end":{"line":425,"col":58,"offset":17282}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/src/.github/workflows/production-deployment.yml","start":{"line":436,"col":20,"offset":17613},"end":{"line":440,"col":55,"offset":17875}}]],"message":"Syntax error at line /src/.github/workflows/production-deployment.yml:436:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `\"R`[i Rollback preparation:\"\necho \"1. Previous state backup created during deployment\"\necho \"2. Deployment tag created for quick identification\"\necho \"3. To rollback: revert to previous git tag and redeploy\"\necho \"4. Emergency contact: Check SECURITY_POLICY.md\"\n` was unexpected","path":"/src/.github/workflows/production-deployment.yml","spans":[{"file":"/src/.github/workflows/production-deployment.yml","start":{"line":436,"col":20,"offset":17613},"end":{"line":440,"col":55,"offset":17875}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/src/.github/workflows/production-deployment.yml","start":{"line":452,"col":10,"offset":18192},"end":{"line":452,"col":51,"offset":18233}},{"path":"/src/.github/workflows/production-deployment.yml","start":{"line":455,"col":30,"offset":18192},"end":{"line":455,"col":33,"offset":18195}},{"path":"/src/.github/workflows/production-deployment.yml","start":{"line":460,"col":11,"offset":18192},"end":{"line":460,"col":33,"offset":18214}}]],"message":"Syntax error at line /src/.github/workflows/production-deployment.yml:452:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `{ needs.post-deployment-validation.result` was unexpected","path":"/src/.github/workflows/production-deployment.yml","spans":[{"file":"/src/.github/workflows/production-deployment.yml","start":{"line":452,"col":10,"offset":18192},"end":{"line":452,"col":51,"offset":18233}},{"file":"/src/.github/workflows/production-deployment.yml","start":{"line":455,"col":30,"offset":18192},"end":{"line":455,"col":33,"offset":18195}},{"file":"/src/.github/workflows/production-deployment.yml","start":{"line":460,"col":11,"offset":18192},"end":{"line":460,"col":33,"offset":18214}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/src/containers/site-generator/templates/article.html","start":{"line":1,"col":1,"offset":0},"end":{"line":5,"col":23,"offset":129}},{"path":"/src/containers/site-generator/templates/article.html","start":{"line":90,"col":1,"offset":0},"end":{"line":90,"col":15,"offset":14}}]],"message":"Syntax error at line /src/containers/site-generator/templates/article.html:1:\n `{% extends \"base.html\" %}\n\n{% block title %}{{ article.title }} | {{ site_metadata.title }}{% endblock %}\n\n{% block extra_head %}` was unexpected","path":"/src/containers/site-generator/templates/article.html","spans":[{"file":"/src/containers/site-generator/templates/article.html","start":{"line":1,"col":1,"offset":0},"end":{"line":5,"col":23,"offset":129}},{"file":"/src/containers/site-generator/templates/article.html","start":{"line":90,"col":1,"offset":0},"end":{"line":90,"col":15,"offset":14}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/src/containers/site-generator/templates/index.html","start":{"line":1,"col":1,"offset":0},"end":{"line":3,"col":20,"offset":46}},{"path":"/src/containers/site-generator/templates/index.html","start":{"line":28,"col":73,"offset":0},"end":{"line":28,"col":95,"offset":22}},{"path":"/src/containers/site-generator/templates/index.html","start":{"line":43,"col":1,"offset":0},"end":{"line":43,"col":30,"offset":29}},{"path":"/src/containers/site-generator/templates/index.html","start":{"line":48,"col":1,"offset":0},"end":{"line":49,"col":15,"offset":26}}]],"message":"Syntax error at line /src/containers/site-generator/templates/index.html:1:\n `{% extends \"base.html\" %}\n\n{% block content %}` was unexpected","path":"/src/containers/site-generator/templates/index.html","spans":[{"file":"/src/containers/site-generator/templates/index.html","start":{"line":1,"col":1,"offset":0},"end":{"line":3,"col":20,"offset":46}},{"file":"/src/containers/site-generator/templates/index.html","start":{"line":28,"col":73,"offset":0},"end":{"line":28,"col":95,"offset":22}},{"file":"/src/containers/site-generator/templates/index.html","start":{"line":43,"col":1,"offset":0},"end":{"line":43,"col":30,"offset":29}},{"file":"/src/containers/site-generator/templates/index.html","start":{"line":48,"col":1,"offset":0},"end":{"line":49,"col":15,"offset":26}}]}],"paths":{"scanned":["/src/.devcontainer/Dockerfile","/src/.devcontainer/devcontainer.json","/src/.env","/src/.env.example","/src/.github/ISSUE_TEMPLATE/ephemeral-pr-environment.md","/src/.github/ISSUE_TEMPLATE/standardize-content-collector.md","/src/.github/agent-instructions.md","/src/.github/pull_request_template.md","/src/.github/workflows/build-and-deploy.yml","/src/.github/workflows/ephemeral-environment.yml","/src/.github/workflows/production-deployment.yml","/src/.github/workflows/security-and-cost-validation.yml","/src/.github/workflows/staging-deployment.yml","/src/.gitignore","/src/.markdownlint.json","/src/Makefile","/src/README.md","/src/conftest.py","/src/containers/README-local-dev.md","/src/containers/collector-scheduler/Dockerfile","/src/containers/collector-scheduler/README.md","/src/containers/collector-scheduler/main.py","/src/containers/collector-scheduler/requirements.txt","/src/containers/content-collector/Dockerfile","/src/containers/content-collector/README.md","/src/containers/content-collector/__init__.py","/src/containers/content-collector/collector.py","/src/containers/content-collector/config.py","/src/containers/content-collector/conftest.py","/src/containers/content-collector/keyvault_client.py","/src/containers/content-collector/main.py","/src/containers/content-collector/models.py","/src/containers/content-collector/pyproject.toml","/src/containers/content-collector/requirements.txt","/src/containers/content-collector/service_logic.py","/src/containers/content-collector/source_collectors.py","/src/containers/content-collector/transforms.py","/src/containers/content-enricher/Dockerfile","/src/containers/content-enricher/README.md","/src/containers/content-enricher/__init__.py","/src/containers/content-enricher/config.py","/src/containers/content-enricher/conftest.py","/src/containers/content-enricher/content_summarizer.py","/src/containers/content-enricher/enricher.py","/src/containers/content-enricher/main.py","/src/containers/content-enricher/mypy.ini","/src/containers/content-enricher/pyproject.toml","/src/containers/content-enricher/requirements.txt","/src/containers/content-enricher/sentiment_analyzer.py","/src/containers/content-enricher/service_logic.py","/src/containers/content-enricher/topic_classifier.py","/src/containers/content-enricher/trend_calculator.py","/src/containers/content-generator/Dockerfile","/src/containers/content-generator/README.md","/src/containers/content-generator/blob_events.py","/src/containers/content-generator/config.py","/src/containers/content-generator/health.py","/src/containers/content-generator/main.py","/src/containers/content-generator/models.py","/src/containers/content-generator/requirements.txt","/src/containers/content-generator/service_logic.py","/src/containers/content-processor/Dockerfile","/src/containers/content-processor/PHASE_2B_COMPLETION_SUMMARY.md","/src/containers/content-processor/README.md","/src/containers/content-processor/config.py","/src/containers/content-processor/conftest.py","/src/containers/content-processor/main.py","/src/containers/content-processor/processor.py","/src/containers/content-processor/pyproject.toml","/src/containers/content-processor/requirements.txt","/src/containers/content-processor/service_logic.py","/src/containers/content-ranker/Dockerfile","/src/containers/content-ranker/README.md","/src/containers/content-ranker/config.py","/src/containers/content-ranker/debug_blob.py","/src/containers/content-ranker/main.py","/src/containers/content-ranker/models.py","/src/containers/content-ranker/ranker.py","/src/containers/content-ranker/requirements.txt","/src/containers/content-ranker/service_logic.py","/src/containers/content-ranker/test_phase2d_integration.py","/src/containers/markdown-generator/.dockerignore","/src/containers/markdown-generator/Dockerfile","/src/containers/markdown-generator/PHASE_2E_COMPLETION_SUMMARY.md","/src/containers/markdown-generator/blob_storage.py","/src/containers/markdown-generator/config.py","/src/containers/markdown-generator/conftest.py","/src/containers/markdown-generator/health.py","/src/containers/markdown-generator/main.py","/src/containers/markdown-generator/main_new.py","/src/containers/markdown-generator/models.py","/src/containers/markdown-generator/pytest.ini","/src/containers/markdown-generator/requirements.txt","/src/containers/markdown-generator/service_logic.py","/src/containers/site-generator/Dockerfile","/src/containers/site-generator/config.py","/src/containers/site-generator/health.py","/src/containers/site-generator/main.py","/src/containers/site-generator/main_new.py","/src/containers/site-generator/main_old.py","/src/containers/site-generator/models.py","/src/containers/site-generator/requirements.txt","/src/containers/site-generator/service_logic.py","/src/containers/site-generator/template_manager.py","/src/containers/site-generator/templates/article.html","/src/containers/site-generator/templates/base.html","/src/containers/site-generator/templates/index.html","/src/containers/site-generator/templates/style.css","/src/docker-compose.yml","/src/docs/AZURE_OPENAI_SETUP.md","/src/docs/CLEANUP_SUMMARY.md","/src/docs/CONTAINER_DEVELOPMENT_STANDARDS.md","/src/docs/CONTAINER_MIGRATION_GUIDE.md","/src/docs/DAILY_REPORT_2025_08_19.md","/src/docs/IMPLEMENTATION_ROADMAP.md","/src/docs/KEYVAULT_IMPLEMENTATION_SUMMARY.md","/src/docs/KEYVAULT_INTEGRATION.md","/src/docs/LOCAL_DEVELOPMENT_KEYVAULT.md","/src/docs/PHASE_2B_CONTENT_PROCESSOR_INTEGRATION_20250819.md","/src/docs/PHASE_2C_CONTENT_ENRICHER_INTEGRATION_20250819.md","/src/docs/PHASE_2D_CONTENT_RANKER_INTEGRATION_20250819.md","/src/docs/PHASE_2E_MARKDOWN_GENERATOR_INTEGRATION_20250819.md","/src/docs/QUICK_START_GUIDE.md","/src/docs/README.md","/src/docs/SYSTEM_ARCHITECTURE.md","/src/docs/TWO_TIER_INFRASTRUCTURE_ARCHITECTURE.md","/src/docs/articles/2025-07-24-sample-topic.md","/src/docs/content-collector-api.md","/src/docs/cost-analysis.md","/src/docs/cost-optimization.md","/src/docs/deployment-guide.md","/src/docs/key-vault-integration.md","/src/docs/security-policy.md","/src/docs/security-testing-report.md","/src/docs/testing-guide.md","/src/infra/.infracost/pricing.gob","/src/infra/.infracost/terraform_modules/manifest.json","/src/infra/README.md","/src/infra/container_apps.tf","/src/infra/core/.terraform.lock.hcl","/src/infra/core/main.tf","/src/infra/core/outputs.tf","/src/infra/core/terraform.tfstate.local-backup","/src/infra/core/variables.tf","/src/infra/cost_monitoring.tf","/src/infra/environments/main.tf","/src/infra/environments/outputs.tf","/src/infra/environments/variables.tf","/src/infra/main.tf","/src/infra/outputs.tf","/src/infra/production.tfvars","/src/infra/providers.tf","/src/infra/sbom-infrastructure.txt","/src/infra/staging.tfvars","/src/infra/terraform.tfstate.d/staging/terraform.tfstate","/src/infra/terraform.tfstate.d/staging/terraform.tfstate.backup","/src/infra/terraform.tfvars.example","/src/infra/usage-estimates.yml","/src/infra/variables.tf","/src/libs/__init__.py","/src/libs/blob_storage.py","/src/libs/pyproject.toml","/src/output/cms/ghost/IMPORT_INSTRUCTIONS.md","/src/output/cms/ghost/live_20250815_164526_breakthrough-in-quantum-computing-error-correction.md","/src/output/cms/ghost/live_20250815_164526_european-parliament-approves-comprehensive-ai-regu.md","/src/output/cms/ghost/live_20250815_164526_open-source-ai-models-challenge-big-tech-dominance.md","/src/output/cms/ghost/live_20250815_164526_uk-announces-2bn-investment-in-ai-infrastructure-a.md","/src/output/cms/ghost/live_20250815_164526_webassembly-adoption-surges-as-developers-embrace-.md","/src/output/cms/ghost/live_20250815_165306_breakthrough-in-quantum-computing-error-correction.md","/src/output/cms/ghost/live_20250815_165306_european-parliament-approves-comprehensive-ai-regu.md","/src/output/cms/ghost/live_20250815_165306_open-source-ai-models-challenge-big-tech-dominance.md","/src/output/cms/ghost/live_20250815_165306_uk-announces-2bn-investment-in-ai-infrastructure-a.md","/src/output/cms/ghost/live_20250815_165306_webassembly-adoption-surges-as-developers-embrace-.md","/src/output/cms/integration_summary.json","/src/output/cms/netlify/admin/config.yml","/src/output/cms/netlify/content/posts/2025-08-15-live_20250815_164526_breakthrough-in-quantum-computing-error-correction.md","/src/output/cms/netlify/content/posts/2025-08-15-live_20250815_164526_european-parliament-approves-comprehensive-ai-regu.md","/src/output/cms/netlify/content/posts/2025-08-15-live_20250815_164526_open-source-ai-models-challenge-big-tech-dominance.md","/src/output/cms/netlify/content/posts/2025-08-15-live_20250815_164526_uk-announces-2bn-investment-in-ai-infrastructure-a.md","/src/output/cms/netlify/content/posts/2025-08-15-live_20250815_164526_webassembly-adoption-surges-as-developers-embrace-.md","/src/output/cms/netlify/content/posts/2025-08-15-live_20250815_165306_breakthrough-in-quantum-computing-error-correction.md","/src/output/cms/netlify/content/posts/2025-08-15-live_20250815_165306_european-parliament-approves-comprehensive-ai-regu.md","/src/output/cms/netlify/content/posts/2025-08-15-live_20250815_165306_open-source-ai-models-challenge-big-tech-dominance.md","/src/output/cms/netlify/content/posts/2025-08-15-live_20250815_165306_uk-announces-2bn-investment-in-ai-infrastructure-a.md","/src/output/cms/netlify/content/posts/2025-08-15-live_20250815_165306_webassembly-adoption-surges-as-developers-embrace-.md","/src/output/cms/strapi/ai_curated_articles.json","/src/output/markdown/curated_20250815_164405_ai-researchers-develop-new-method-for-quantum-comp.md","/src/output/markdown/curated_20250815_164405_container-orchestration-evolves-with-webassembly-i.md","/src/output/markdown/curated_20250815_164405_index.md","/src/output/markdown/curated_20250815_164405_uk-tech-startups-see-record-funding-amid-ai-boom.md","/src/output/markdown/curated_20250815_165307_ai-researchers-develop-new-method-for-quantum-comp.md","/src/output/markdown/curated_20250815_165307_container-orchestration-evolves-with-webassembly-i.md","/src/output/markdown/curated_20250815_165307_index.md","/src/output/markdown/curated_20250815_165307_uk-tech-startups-see-record-funding-amid-ai-boom.md","/src/output/markdown/live_20250815_164526_breakthrough-in-quantum-computing-error-correction.md","/src/output/markdown/live_20250815_164526_european-parliament-approves-comprehensive-ai-regu.md","/src/output/markdown/live_20250815_164526_index.md","/src/output/markdown/live_20250815_164526_open-source-ai-models-challenge-big-tech-dominance.md","/src/output/markdown/live_20250815_164526_uk-announces-2bn-investment-in-ai-infrastructure-a.md","/src/output/markdown/live_20250815_164526_webassembly-adoption-surges-as-developers-embrace-.md","/src/output/markdown/live_20250815_165306_breakthrough-in-quantum-computing-error-correction.md","/src/output/markdown/live_20250815_165306_european-parliament-approves-comprehensive-ai-regu.md","/src/output/markdown/live_20250815_165306_index.md","/src/output/markdown/live_20250815_165306_open-source-ai-models-challenge-big-tech-dominance.md","/src/output/markdown/live_20250815_165306_uk-announces-2bn-investment-in-ai-infrastructure-a.md","/src/output/markdown/live_20250815_165306_webassembly-adoption-surges-as-developers-embrace-.md","/src/output/markdown/publishing_manifest.json","/src/pytest.ini","/src/python-safety-results.json","/src/python-semgrep-results.json","/src/python-trivy-results.json","/src/scripts/README.md","/src/scripts/cms_integration.py","/src/scripts/cost-analysis.sh","/src/scripts/cost-calculator.py","/src/scripts/deploy-containers.sh","/src/scripts/generate_markdown.py","/src/scripts/process_live_content.py","/src/scripts/run_pipeline.sh","/src/scripts/setup-azure-openai.sh","/src/scripts/setup-core-infrastructure.sh","/src/scripts/setup-environment-infrastructure.sh","/src/scripts/setup-keyvault.sh","/src/scripts/setup-local-dev.sh","/src/scripts/setup_azure_openai_example.sh","/src/scripts/start-event-driven-pipeline.sh","/src/scripts/test-pipeline.sh","/src/scripts/update-content-generator-config.sh","/src/security-summary.txt"]},"time":{"rules":[],"rules_parse_time":3.3336360454559326,"profiling_times":{"config_time":17.764726161956787,"core_time":8.455457448959351,"ignores_time":0.004980802536010742,"total_time":26.227243661880493},"parsing_time":{"total_time":1.7993981838226318,"per_file_time":{"mean":0.016661094294653997,"std_dev":0.0004423351863977746},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":24.519346475601196,"per_file_time":{"mean":0.0425683098534743,"std_dev":0.03256817230253888},"very_slow_stats":{"time_ratio":0.28556393520664347,"count_ratio":0.006944444444444444},"very_slow_files":[{"fpath":"/src/containers/site-generator/main_old.py","ftime":1.6199610233306885},{"fpath":"/src/containers/content-collector/collector.py","ftime":1.7573869228363037},{"fpath":"/src/containers/content-collector/source_collectors.py","ftime":1.7825639247894287},{"fpath":"/src/containers/content-generator/service_logic.py","ftime":1.8419291973114014}]},"matching_time":{"total_time":12.623416662216187,"per_file_and_rule_time":{"mean":0.008748036494952309,"std_dev":0.001572826314262485},"very_slow_stats":{"time_ratio":0.41908734688089644,"count_ratio":0.015246015246015246},"very_slow_rules_on_files":[{"fpath":"/src/containers/content-ranker/models.py","rule_id":"python.lang.security.audit.insecure-transport.requests.request-with-http.request-with-http","time":0.1778099536895752},{"fpath":"/src/containers/site-generator/main_old.py","rule_id":"python.lang.security.dangerous-system-call.dangerous-system-call","time":0.1790328025817871},{"fpath":"/src/containers/content-enricher/config.py","rule_id":"python.lang.security.audit.insecure-transport.requests.request-with-http.request-with-http","time":0.1839289665222168},{"fpath":"/src/containers/site-generator/main_old.py","rule_id":"python.django.security.injection.path-traversal.path-traversal-open.path-traversal-open","time":0.19991707801818848},{"fpath":"/src/containers/content-processor/config.py","rule_id":"python.lang.security.audit.insecure-transport.requests.request-with-http.request-with-http","time":0.23073887825012207},{"fpath":"/src/containers/site-generator/models.py","rule_id":"python.lang.security.audit.insecure-transport.requests.request-with-http.request-with-http","time":0.25458407402038574},{"fpath":"/src/containers/site-generator/health.py","rule_id":"python.lang.security.audit.insecure-transport.requests.request-with-http.request-with-http","time":0.3026769161224365},{"fpath":"/src/containers/content-collector/collector.py","rule_id":"python.lang.security.audit.insecure-transport.requests.request-with-http.request-with-http","time":0.6317160129547119},{"fpath":"/src/containers/content-collector/source_collectors.py","rule_id":"python.lang.security.audit.insecure-transport.requests.request-with-http.request-with-http","time":0.6829419136047363},{"fpath":"/src/scripts/process_live_content.py","rule_id":"python.lang.security.audit.insecure-transport.requests.request-with-http.request-with-http","time":0.8665130138397217}]},"tainting_time":{"total_time":3.754973888397217,"per_def_and_rule_time":{"mean":0.0015567885109441196,"std_dev":4.587017030544779e-05},"very_slow_stats":{"time_ratio":0.16520579507847297,"count_ratio":0.0020729684908789387},"very_slow_rules_on_defs":[{"fpath":"/src/scripts/cms_integration.py","fline":247,"rule_id":"python.boto3.security.hardcoded-token.hardcoded-token","time":0.06549215316772461},{"fpath":"/src/containers/content-collector/collector.py","fline":339,"rule_id":"python.boto3.security.hardcoded-token.hardcoded-token","time":0.06892514228820801},{"fpath":"/src/scripts/cms_integration.py","fline":27,"rule_id":"python.boto3.security.hardcoded-token.hardcoded-token","time":0.09194111824035645},{"fpath":"/src/containers/content-enricher/topic_classifier.py","fline":11,"rule_id":"python.boto3.security.hardcoded-token.hardcoded-token","time":0.18903303146362305},{"fpath":"/src/containers/content-collector/source_collectors.py","fline":427,"rule_id":"python.boto3.security.hardcoded-token.hardcoded-token","time":0.20495200157165527}]},"targets":[],"total_bytes":0,"max_memory_bytes":1109085440},"engine_requested":"OSS","skipped_rules":[]}