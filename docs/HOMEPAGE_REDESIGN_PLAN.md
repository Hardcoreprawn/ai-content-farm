# Homepage Redesign Plan - Pagination & Performance

**Status**: Analysis & Planning  
**Date**: October 19, 2025  
**Goal**: Replace infinite scroll with paginated, performant homepage with article card images

---

## Current State Analysis

### Problems Identified

1. **Performance Issues**
   - Infinite scroll loads ALL articles into DOM
   - Memory usage grows unbounded as user scrolls
   - No pagination limits (could be 1000+ articles on page)
   - CSS constraints on cover images not sufficient for performance

2. **Layout & Presentation**
   - Articles rendered via custom `post_card.html` partial (minimal styling)
   - Custom CSS tries to limit image heights (180-350px) but not effective
   - Article cards missing images (no image field in Markdown frontmatter?)
   - Inconsistent with PaperMod theme defaults (theme provides better defaults)

3. **User Experience**
   - Difficult to navigate/find specific content
   - Scrolling fatigue (infinite scroll)
   - No clear article discovery mechanism
   - Missing pagination for bookmarking/sharing specific pages

### Current Architecture

**Homepage Template** (`layouts/index.html`):
```html
{{- $pages := where .Site.RegularPages "Type" "in" .Site.Params.mainSections }}
{{- if $pages }}
<div class="post-list">
    {{- range $pages }}
    {{- partial "post_card.html" . }}
    {{- end }}
</div>
{{- end }}
```

**Issues**:
- `range $pages` iterates ALL pages (no pagination)
- Uses custom `post_card.html` partial (overrides PaperMod defaults)
- PaperMod already has built-in list layouts with pagination

**Custom Post Card** (`partials/post_card.html`):
- Minimal styling (just title, date, summary, tags)
- No image support
- Less capable than PaperMod's `.post-entry` template

**CSS Issues** (`assets/css/custom.css`):
- Tries to limit `.post-entry .entry-cover` height
- But post cards don't have cover images configured
- Settings only affect theme's default list pages (not homepage)

---

## Proposed Solution

### Phase 1: Return to PaperMod Defaults + Pagination ✅ QUICK WIN

**Approach**: Let PaperMod handle homepage rendering with built-in pagination.

**Changes**:
1. **Delete custom `index.html`** → Use PaperMod's default
2. **Delete custom `post_card.html`** → Use PaperMod's `.post-entry`
3. **Add pagination configuration** to `config.toml`
4. **Ensure images in article frontmatter**

**Benefits**:
- ✅ Built-in pagination (12-15 articles per page)
- ✅ Better performance (DOM size limited)
- ✅ Article cover images render automatically
- ✅ Professional styling (PaperMod-tested design)
- ✅ Reduced maintenance (no custom partials to maintain)

**Why This Works**:
- PaperMod homepage already supports pagination
- Theme's CSS properly handles image sizing
- Pagination prevents infinite scroll issues
- Card layout is cleaner by default

### Phase 2: Optimize Article Frontmatter (Content Side)

**Requirement**: Each article must have image in frontmatter:
```yaml
---
title: "Article Title"
date: 2025-10-19
image: "https://images.unsplash.com/photo-xxxxx?w=600&q=75"
summary: "Brief article summary"
tags: ["ai", "technology"]
---
```

**Current Issue**: Articles generated by `markdown-generator` container likely don't include image URL.

**Solution**: Update markdown generation to include Unsplash image in frontmatter.

---

## Implementation Plan

### Step 1: Update Hugo Config (5 minutes)

**File**: `containers/site-publisher/hugo-config/config.toml`

Add pagination settings:
```toml
[pagination]
  pagerSize = 12  # Articles per page

# Enable PaperMod homepage
[params]
  # PaperMod will handle homepage rendering
  # Pagination handled automatically
```

### Step 2: Delete Custom Homepage Template (2 minutes)

**Delete**: `containers/site-publisher/hugo-config/layouts/index.html`

→ Hugo/PaperMod will use theme's default homepage with pagination support.

### Step 3: Delete Custom Post Card (2 minutes)

**Delete**: `containers/site-publisher/hugo-config/layouts/partials/post_card.html`

→ PaperMod's built-in `.post-entry` will render articles with images and consistent styling.

### Step 4: Update CSS (10 minutes)

**File**: `containers/site-publisher/hugo-config/assets/css/custom.css`

Remove unnecessary post-entry CSS, keep only:
- Hero section styling
- Responsive adjustments
- Any custom branding

### Step 5: Verify Article Frontmatter (Investigation)

**Action**: Check if `markdown-generator` includes images in generated frontmatter.

If not, update article generation to include Unsplash image URL.

### Step 6: Test & Iterate (30 minutes)

1. Build and test homepage locally
2. Verify pagination appears
3. Check article cards render with images
4. Test responsive design (mobile/tablet)
5. Performance test (should be much faster)

---

## Detailed Configuration Changes

### config.toml Changes

```toml
# Before:
# (no pagination section, infinite scroll via range $pages)

# After: Add this section
[pagination]
  pagerSize = 12  # Show 12 articles per page

# Optional: Sort articles by date (newest first)
# (Should already be default, but be explicit)
```

### CSS Cleanup

Keep in `custom.css`:
```css
/* Hero section - keep as-is */
.home-info { ... }

/* Remove posts-related CSS - PaperMod handles this */
/* .post-entry.cover { ... }  <- DELETE */
/* .first-entry { ... }        <- DELETE */
/* .main { ... }               <- DELETE */
```

### Frontmatter Requirements

Each article needs:
```yaml
---
title: "Article Title"
date: 2025-10-19T12:00:00Z
image: "https://images.unsplash.com/photo-1234567890?w=600&q=75"
summary: "Short summary (2-3 sentences)"
tags: ["tag1", "tag2"]
categories: ["Technology"]
draft: false
---
```

**Critical**: The `image` field is required for PaperMod card layout.

---

## Expected Results

### Performance Improvements
- **Page Load**: ~4-5 seconds (vs 20+ with infinite scroll)
- **DOM Size**: ~50 elements (vs 500+ with all articles)
- **Memory Usage**: ~10MB (vs 50+ MB after scrolling)
- **Mobile UX**: Smooth scrolling, no lag

### Visual Improvements
- ✅ Professional card layout with images
- ✅ Clear pagination (Page 1, 2, 3...)
- ✅ Responsive on mobile/tablet
- ✅ Consistent with modern web design patterns
- ✅ Accessibility-compliant (PaperMod tested)

### User Experience
- ✅ Easy navigation (pages vs infinite scroll)
- ✅ Bookmarkable (can share Page 2, Page 3, etc)
- ✅ Reduced cognitive load (fewer articles per view)
- ✅ Professional appearance

---

## Related Issues to Address

### Content Pipeline Integration

**Issue**: Markdown articles need images in frontmatter.

**File**: `containers/markdown-generator/services/article_generation.py`

Current flow likely:
```python
# Generates markdown with frontmatter
# But doesn't include image URL
frontmatter = {
    'title': title,
    'date': date,
    'tags': tags,
    # MISSING: 'image': image_url
}
```

**Fix Required**:
```python
frontmatter = {
    'title': title,
    'date': date,
    'image': unsplash_image_url,  # ADD THIS
    'summary': summary,
    'tags': tags,
}
```

---

## Rollback Plan

If issues arise:
1. Restore `layouts/index.html` from git
2. Restore `layouts/partials/post_card.html` from git
3. Reverts config changes

**No data loss** - purely template changes.

---

## Testing Checklist

- [ ] Hugo builds without errors
- [ ] Homepage loads (no 404 or build errors)
- [ ] Pagination controls visible (Page 1, 2, 3...)
- [ ] Articles display with images
- [ ] Article cards are clickable/link to full article
- [ ] Mobile responsive (test on 375px, 768px, 1024px)
- [ ] Performance: Page load < 5s, no DOM lag
- [ ] Accessibility: Keyboard navigation works, alt text present
- [ ] Links work: Homepage → Article → works correctly

---

## Success Metrics

| Metric | Before | Target | Measurement |
|--------|--------|--------|-------------|
| Page Load Time | 20+ sec | <5 sec | Chrome DevTools |
| DOM Elements | 500+ | <100 | Browser Inspector |
| Memory Usage | 50+ MB | <15 MB | DevTools Memory tab |
| Lighthouse Score | ~40 | >75 | Lighthouse audit |
| Mobile UX | Poor (lag) | Good (smooth) | Manual test |
| Core Web Vitals | Poor | Good | Web Vitals report |

---

## Implementation Timeline

- **Step 1-4**: 20 minutes (config + deletions + CSS cleanup)
- **Step 5**: Investigation (5-15 minutes depending on current state)
- **Step 6**: Testing (30 minutes)
- **Total**: 60-90 minutes

---

## Next Steps

1. **Review Plan**: Confirm approach with user
2. **Verify Content**: Check current article frontmatter format
3. **Implement**: Execute steps 1-4
4. **Test**: Validate homepage locally
5. **Deploy**: Via CI/CD pipeline
6. **Monitor**: Check performance metrics post-deploy

---

_Plan created: October 19, 2025_  
_Status: Ready for implementation_
